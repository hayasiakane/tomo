{% extends "base.html" %} {% block content %}
<!-- è‡ªå®šä¹‰ CSS -->
<style>
  /* æ ‡é¢˜åŠ¨ç”» */
  @keyframes titlePulse {
    0% {
      transform: scale(1);
      opacity: 0.9;
    }
    50% {
      transform: scale(1.02);
      opacity: 1;
    }
    100% {
      transform: scale(1);
      opacity: 0.9;
    }
  }

  /* å“åº”å¼æ ‡é¢˜è°ƒæ•´ */
  .hero-title-container {
    margin-bottom: 1.8rem;
    text-align: center;
  }

  .hero-tagline {
    font-size: 2.2rem;
    line-height: 1.3;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
  }

  .hero-tagline span {
    display: inline-block;
    animation: titlePulse 3s infinite;
  }

  .hero-tagline .second-part {
    animation-delay: 1.5s;
  }

  /* å“åº”å¼è°ƒæ•´ */
  @media (max-width: 767.98px) {
    .hero-tagline {
      font-size: 1.8rem;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    .hero-tagline span {
      display: block;
    }

    .hero-tagline .second-part {
      margin-top: 0.3rem;
    }
  }

  @media (max-width: 575.98px) {
    .hero-tagline {
      font-size: 1.5rem;
    }
  }

  /* å‰¯æ ‡é¢˜æ ·å¼ */
  .hero-description {
    opacity: 0.9;
    line-height: 1.7;
    margin-bottom: 2rem;
  }

  .subtitle-line {
    margin-bottom: 0.5rem;
  }

  .subtitle-line:last-child {
    margin-bottom: 0;
  }

  /* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
  .hero-buttons {
    margin-top: 2rem;
    display: flex;
    justify-content: center;
  }

  .btn-discover {
    padding: 0.7rem 1.8rem;
    font-weight: 600;
    border-radius: 50px;
    transition: all 0.3s ease;
    background-color: var(--primary-color);
    border: none;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    letter-spacing: 0.5px;
    font-size: 1.8rem;
  }

  .btn-discover:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    background-color: var(--primary-color-dark, #e67e22);
  }

  .btn-join {
    padding: 0.7rem 1.8rem;
    font-weight: 600;
    border-radius: 50px;
    transition: all 0.3s ease;
    border: 1px solid #e0e0e0;
    background-color: transparent;
    letter-spacing: 0.5px;
    font-size: 1.8rem;
  }

  .btn-join:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    background-color: #f8f9fa;
  }

  .food-icon {
    display: inline-block;
    margin-right: 8px;
    position: relative;
    top: -1px;
  }

  /* åˆ†ç±»å¡ç‰‡äº¤äº’æ•ˆæœ */
  .category-card {
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .category-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
  }

  .category-card:hover .category-icon {
    transform: scale(1.1);
  }
</style>

<!-- ä¸»é¡µè‹±é›„åŒºåŸŸ -->
<div
  class="hero-section rounded-4 p-4 p-md-5 mb-5"
  style="
    background: linear-gradient(135deg, var(--light-accent) 0%, #fff8f0 100%);
  "
>
  <div class="row align-items-center">
    <div class="col-md-6">
      <!-- æ™®é€šç”¨æˆ·/æœªç™»å½•ç”¨æˆ·å†…å®¹ -->
      <div id="regular-user-content">
        <div class="hero-title-container">
          <h1 class="hero-tagline">
            <span>ç¾é£Ÿä¸æ­¢äºå‘³è•¾</span>
            <span class="second-part">æ›´æ˜¯æ—¶å…‰çš„è®°å¿†</span>
          </h1>
        </div>
        <div class="hero-description text-center">
          <div class="subtitle-line">ä¸å¿—åŒé“åˆçš„é£Ÿå‹ä¸€èµ·</div>
          <div class="subtitle-line">å®šæ ¼æ¯ä¸€åˆ»èˆŒå°–ä¸Šçš„æ„ŸåŠ¨</div>
          <div class="subtitle-line">ç•™ä½æ¯ä¸€æ®µç¾å‘³çš„æ•…äº‹</div>
        </div>
        <div class="hero-buttons">
          <a href="/restaurants" class="btn btn-lg btn-discover me-3">
            <span class="food-icon">ğŸ½ï¸</span>æ¢ç´¢ç¾é£Ÿ
          </a>
          <a href="/register" class="btn btn-lg btn-join" id="join-us-btn">
            <i class="bi bi-person-plus me-2"></i>åŠ å…¥æˆ‘ä»¬
          </a>
        </div>
      </div>

      <!-- å•†å®¶ç”¨æˆ·å†…å®¹ -->
      <div id="business-user-content" style="display: none">
        <div class="hero-title-container">
          <h1 class="hero-tagline">æ¬¢è¿å›åˆ°æ‚¨çš„é¤å…ç®¡ç†ä¸­å¿ƒ</h1>
        </div>
        <div class="hero-description text-center">
          ç®¡ç†æ‚¨çš„é¤å…ä¿¡æ¯ï¼Œå›å¤é¡¾å®¢è¯„ä»·ï¼Œå‘å¸ƒæœ€æ–°æ´»åŠ¨ä¸ä¼˜æƒ 
        </div>
        <div class="hero-buttons">
          <a href="/my-restaurants" class="btn btn-lg btn-discover me-3">
            <i class="bi bi-shop me-2"></i>æˆ‘çš„é¤å…
          </a>
          <a href="/restaurant/add" class="btn btn-lg btn-join">
            <i class="bi bi-plus-circle me-2"></i>æ·»åŠ é¤å…
          </a>
        </div>
      </div>
    </div>
    <div class="col-md-6 mt-4 mt-md-0">
      <!-- è½®æ’­å›¾æ›¿æ¢é™æ€å›¾ç‰‡ -->
      <div
        id="restaurantCarousel"
        class="carousel slide rounded-4 shadow-lg overflow-hidden"
        data-bs-ride="carousel"
      >
        <div class="carousel-indicators">
          <button
            type="button"
            data-bs-target="#restaurantCarousel"
            data-bs-slide-to="0"
            class="active"
            aria-current="true"
            aria-label="Slide 1"
          ></button>
          <button
            type="button"
            data-bs-target="#restaurantCarousel"
            data-bs-slide-to="1"
            aria-label="Slide 2"
          ></button>
          <button
            type="button"
            data-bs-target="#restaurantCarousel"
            data-bs-slide-to="2"
            aria-label="Slide 3"
          ></button>
        </div>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img
              src="{{ url_for('static', filename='images/restaurant-interior.jpg') }}"
              class="d-block w-100"
              alt="ç²¾è‡´é¤å…"
              style="height: 350px; object-fit: cover"
            />
            <div
              class="carousel-caption d-none d-md-block"
              style="
                background: rgba(0, 0, 0, 0.5);
                border-radius: 8px;
                padding: 8px;
              "
            >
              <h5 class="mb-0">ç²¾è‡´é¤å…ä½“éªŒ</h5>
              <p class="mb-0 small">äº«å—é«˜å“è´¨çš„ç”¨é¤ç¯å¢ƒ</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="{{ url_for('static', filename='images/delicious-food.jpg') }}"
              class="d-block w-100"
              alt="ç¾å‘³ä½³è‚´"
              style="height: 350px; object-fit: cover"
            />
            <div
              class="carousel-caption d-none d-md-block"
              style="
                background: rgba(0, 0, 0, 0.5);
                border-radius: 8px;
                padding: 8px;
              "
            >
              <h5 class="mb-0">ç¾å‘³ä½³è‚´</h5>
              <p class="mb-0 small">å‘ç°åŸå¸‚é‡Œçš„å‘³è•¾æƒŠå–œ</p>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="{{ url_for('static', filename='images/dessert.jpg') }}"
              class="d-block w-100"
              alt="ç”œç‚¹é¥®å“"
              style="height: 350px; object-fit: cover"
            />
            <div
              class="carousel-caption d-none d-md-block"
              style="
                background: rgba(0, 0, 0, 0.5);
                border-radius: 8px;
                padding: 8px;
              "
            >
              <h5 class="mb-0">ç²¾è‡´ç”œç‚¹</h5>
              <p class="mb-0 small">ç»“æŸä¸€é¤çš„å®Œç¾æ–¹å¼</p>
            </div>
          </div>
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#restaurantCarousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#restaurantCarousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>

        <!-- ç”¨æˆ·æ¨èæ ‡ç­¾ -->
        <div
          class="position-absolute top-0 end-0 bg-white rounded-pill py-2 px-3 m-3 shadow-sm d-flex align-items-center"
        >
          <i class="bi bi-heart-fill text-danger me-2"></i>
          <span class="fw-bold">ç”¨æˆ·æ¨è</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ç‰¹è‰²åˆ†ç±»åŒº -->
<div class="row mb-5">
  <div class="col-12 text-center mb-4">
    <h2 class="mb-2">å¯»æ‰¾ä½ çš„ç¾é£Ÿçµæ„Ÿ</h2>
    <p class="text-muted">æ¢ç´¢å¤šç§ç¾é£Ÿåˆ†ç±»ï¼Œæ‰¾åˆ°ä½ çš„å¿ƒå¤´å¥½</p>
  </div>
  <div class="col-md-3 col-6 mb-4">
    <a href="/restaurants?cuisine=ä¸­é¤" class="text-decoration-none">
      <div class="card border-0 bg-light h-100 text-center category-card">
        <div class="card-body py-4">
          <div
            class="mb-3 mx-auto category-icon"
            style="
              width: 60px;
              height: 60px;
              background-color: #fde2e2;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              transition: transform 0.3s ease;
            "
          >
            <i class="bi bi-cup-straw fs-3" style="color: #e74c3c"></i>
          </div>
          <h5 class="card-title">ä¸­é¤</h5>
          <p class="card-text small text-muted">ä¼ ç»Ÿç¾å‘³ï¼Œå›å‘³æ— ç©·</p>
        </div>
      </div>
    </a>
  </div>
  <div class="col-md-3 col-6 mb-4">
    <a href="/restaurants?cuisine=è¥¿é¤" class="text-decoration-none">
      <div class="card border-0 bg-light h-100 text-center category-card">
        <div class="card-body py-4">
          <div
            class="mb-3 mx-auto category-icon"
            style="
              width: 60px;
              height: 60px;
              background-color: #e0f7fa;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              transition: transform 0.3s ease;
            "
          >
            <i class="bi bi-egg-fried fs-3" style="color: #00acc1"></i>
          </div>
          <h5 class="card-title">è¥¿é¤</h5>
          <p class="card-text small text-muted">å¼‚åŸŸé£æƒ…ï¼Œç²¾è‡´å“å‘³</p>
        </div>
      </div>
    </a>
  </div>
  <div class="col-md-3 col-6 mb-4">
    <a href="/restaurants?cuisine=çƒ§çƒ¤" class="text-decoration-none">
      <div class="card border-0 bg-light h-100 text-center category-card">
        <div class="card-body py-4">
          <div
            class="mb-3 mx-auto category-icon"
            style="
              width: 60px;
              height: 60px;
              background-color: #fff3e0;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              transition: transform 0.3s ease;
            "
          >
            <i class="bi bi-fire fs-3" style="color: #ff9800"></i>
          </div>
          <h5 class="card-title">çƒ§çƒ¤</h5>
          <p class="card-text small text-muted">é¦™æ°”å››æº¢çš„ç¾å‘³é€‰æ‹©</p>
        </div>
      </div>
    </a>
  </div>
  <div class="col-md-3 col-6 mb-4">
    <a href="/restaurants?cuisine=ç«é”…" class="text-decoration-none">
      <div class="card border-0 bg-light h-100 text-center category-card">
        <div class="card-body py-4">
          <div
            class="mb-3 mx-auto category-icon"
            style="
              width: 60px;
              height: 60px;
              background-color: #e8f5e9;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              transition: transform 0.3s ease;
            "
          >
            <i class="bi bi-bucket fs-3" style="color: #4caf50"></i>
          </div>
          <h5 class="card-title">ç«é”…</h5>
          <p class="card-text small text-muted">çƒ­æ°”è…¾è…¾ï¼Œæ¸©æš–å…±äº«</p>
        </div>
      </div>
    </a>
  </div>
</div>

<!-- çƒ­é—¨é¤å…åŒº -->
<div class="row mb-5">
  <div class="col-12 mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h2 class="mb-1">çƒ­é—¨é¤å…</h2>
        <p class="text-muted mb-0">æœ€å—é£Ÿå‹ä»¬å–œçˆ±çš„ç¾é£Ÿåœ°æ ‡</p>
      </div>
      <a href="/restaurants" class="btn btn-sm btn-outline-primary">æŸ¥çœ‹å…¨éƒ¨</a>
    </div>
  </div>
  <div class="col-12">
    <div class="row" id="featured-restaurants">
      <!-- åŠ¨æ€åŠ è½½çƒ­é—¨é¤å… -->
      <div class="col-12 text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">åŠ è½½ä¸­...</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- æœ€æ–°è¯„ä»·åŒº -->
<div class="row mb-4">
  <div class="col-12 mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h2 class="mb-1">æœ€æ–°é£Ÿè¯„</h2>
        <p class="text-muted mb-0">çœ‹çœ‹å¤§å®¶éƒ½åœ¨åˆ†äº«ä»€ä¹ˆç¾é£Ÿä½“éªŒ</p>
      </div>
      <a href="/my-reviews" class="btn btn-sm btn-outline-primary">å†™é£Ÿè¯„</a>
    </div>
  </div>
  <div class="col-12">
    <div class="row" id="latest-reviews">
      <!-- åŠ¨æ€åŠ è½½æœ€æ–°è¯„ä»· -->
      <div class="col-12 text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">åŠ è½½ä¸­...</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ç¾é£Ÿç¤¾åŒºå®£ä¼ åŒº -->
<div class="row">
  <div class="col-12">
    <div class="card border-0 rounded-4 overflow-hidden">
      <div class="card-body p-0">
        <div class="row g-0">
          <div class="col-md-6">
            <img
              src="{{ url_for('static', filename='images/friends-dining.jpg') }}"
              class="img-fluid h-100 w-100"
              style="object-fit: cover"
              alt="æœ‹å‹èšé¤"
            />
          </div>
          <div class="col-md-6 d-flex align-items-center">
            <div class="p-5">
              <h3 class="mb-3">ä¸ç¾é£Ÿå¥½å‹ä¸€èµ·æ¢ç´¢</h3>
              <p class="mb-4">
                å…³æ³¨å¿—åŒé“åˆçš„ç¾é£Ÿå®¶ï¼Œå»ºç«‹è‡ªå·±çš„å‘³è•¾ç¤¾äº¤åœˆï¼Œå…±åŒåˆ†äº«ç¾é£Ÿæ•…äº‹ä¸å‘ç°
              </p>
              <a href="/friends" class="btn btn-primary">æ¢ç´¢å¥½å‹åœˆ</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  // æ·»åŠ æ ‡é¢˜å‘¼å¸æ•ˆæœçš„CSS
  const styleSheet = document.createElement("style");
  styleSheet.textContent = `
    @keyframes titlePulse {
      0% { opacity: 0.9; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.02); }
      100% { opacity: 0.9; transform: scale(1); }
    }
  `;
  document.head.appendChild(styleSheet);

  document.addEventListener("DOMContentLoaded", function () {
    // æ£€æŸ¥ç™»å½•çŠ¶æ€å¹¶æ ¹æ®ç”¨æˆ·ç±»å‹æ˜¾ç¤ºä¸åŒå†…å®¹
    const token = localStorage.getItem("token");
    const userType = localStorage.getItem("type");

    if (token) {
      // ç”¨æˆ·å·²ç™»å½•
      const joinUsBtn = document.getElementById("join-us-btn");
      if (joinUsBtn) {
        joinUsBtn.style.display = "none";
      }

      // æ ¹æ®ç”¨æˆ·ç±»å‹æ˜¾ç¤ºä¸åŒå†…å®¹
      if (userType === "business") {
        // å•†å®¶ç”¨æˆ·
        document.getElementById("regular-user-content").style.display = "none";
        document.getElementById("business-user-content").style.display =
          "block";
      }
    }

    // åˆ†ç±»å¡ç‰‡ç‚¹å‡»äº‹ä»¶
    document.querySelectorAll(".category-card").forEach((card) => {
      card.addEventListener("click", function (e) {
        // é˜²æ­¢aæ ‡ç­¾çš„é»˜è®¤è·³è½¬ï¼Œè¿™é‡Œæˆ‘ä»¬æ‰‹åŠ¨å¤„ç†
        e.preventDefault();

        // è·å–çˆ¶å…ƒç´ çš„aæ ‡ç­¾href
        const href = this.parentElement.getAttribute("href");

        // æ·»åŠ ç‚¹å‡»åŠ¨ç”»æ•ˆæœ
        this.classList.add("active");

        // 300msåè·³è½¬ï¼Œç»™åŠ¨ç”»æ•ˆæœç•™å‡ºæ—¶é—´
        setTimeout(() => {
          window.location.href = href;
        }, 300);
      });
    });

    // è·å–çƒ­é—¨é¤å…
    axios
      .get("/api/restaurants?limit=4")
      .then((response) => {
        const container = document.getElementById("featured-restaurants");
        container.innerHTML = "";

        response.data.restaurants.forEach((restaurant) => {
          const card = `
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="card h-100 restaurant-card border-0 shadow-sm">
                            <div class="position-relative">
                                <img src="${
                                  restaurant.image ||
                                  "/static/images/restaurant-interior.jpg"
                                }" 
                                     class="card-img-top" alt="${
                                       restaurant.name
                                     }" style="height: 180px; object-fit: cover;">
                                <div class="position-absolute bottom-0 start-0 bg-dark bg-opacity-50 text-white p-2 m-2 rounded-pill small">
                                    <i class="bi bi-geo-alt me-1"></i>${
                                      restaurant.location || "å¸‚ä¸­å¿ƒ"
                                    }
                                </div>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title mb-1">${
                                  restaurant.name
                                }</h5>
                                <p class="card-text text-muted small mb-2">${
                                  restaurant.cuisine || "å¤šå›½æ–™ç†"
                                }</p>
                                <div class="rating mb-3">
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-half"></i>
                                    <span class="ms-1">4.5</span>
                                    <span class="text-muted small ms-2">(${
                                      Math.floor(Math.random() * 100) + 20
                                    }æ¡è¯„ä»·)</span>
                                </div>
                                <a href="/restaurants/${
                                  restaurant.restaurantId
                                }" class="btn btn-sm btn-outline-primary w-100">æŸ¥çœ‹è¯¦æƒ…</a>
                            </div>
                        </div>
                    </div>
                `;
          container.innerHTML += card;
        });

        // å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤ºé»˜è®¤å¡ç‰‡
        if (
          !response.data.restaurants ||
          response.data.restaurants.length === 0
        ) {
          const demoCards = generateDemoRestaurants();
          container.innerHTML = demoCards;
        }
      })
      .catch((error) => {
        console.error("è·å–é¤å…å¤±è´¥:", error);
        // æ˜¾ç¤ºé»˜è®¤å¡ç‰‡
        const demoCards = generateDemoRestaurants();
        document.getElementById("featured-restaurants").innerHTML = demoCards;
      });

    // è·å–æœ€æ–°è¯„ä»·
    axios
      .get("/api/reviews/latest")
      .then((response) => {
        const container = document.getElementById("latest-reviews");
        container.innerHTML = "";

        response.data.reviews.forEach((review) => {
          const reviewCard = `
                    <div class="col-md-6 mb-4">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="flex-shrink-0">
                                        <div class="rounded-circle bg-light d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                            <i class="bi bi-person text-secondary"></i>
                                        </div>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <h6 class="mb-0">${
                                          review.user.name || "ç¾é£Ÿçˆ±å¥½è€…"
                                        }</h6>
                                        <p class="text-muted small mb-0">${new Date(
                                          review.timestamp || new Date()
                                        ).toLocaleDateString()}</p>
                                    </div>
                                    <div class="rating ms-auto">
                                        ${'<i class="bi bi-star-fill"></i>'.repeat(
                                          review.rating || 5
                                        )}
                                        ${'<i class="bi bi-star"></i>'.repeat(
                                          5 - (review.rating || 5)
                                        )}
                                    </div>
                                </div>
                                <h5 class="card-title">${
                                  review.restaurant?.name || "äººæ°”é¤å…"
                                }</h5>
                                <p class="card-text">${
                                  review.content ||
                                  "è¿™å®¶é¤å…çš„èœå“éå¸¸ç¾å‘³ï¼ŒæœåŠ¡ä¹Ÿå¾ˆå‘¨åˆ°ï¼Œç¯å¢ƒä¼˜é›…èˆ’é€‚ï¼Œå€¼å¾—æ¨èç»™å¤§å®¶ï¼"
                                }</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <button class="btn btn-sm btn-light me-2">
                                            <i class="bi bi-hand-thumbs-up me-1"></i>ç‚¹èµ
                                        </button>
                                        <button class="btn btn-sm btn-light">
                                            <i class="bi bi-chat me-1"></i>è¯„è®º
                                        </button>
                                    </div>
                                    <a href="/restaurants/${
                                      review.restaurant?.restaurantId || "#"
                                    }" class="btn btn-sm btn-outline-primary">æŸ¥çœ‹é¤å…</a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
          container.innerHTML += reviewCard;
        });

        // å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤ºé»˜è®¤å¡ç‰‡
        if (!response.data.reviews || response.data.reviews.length === 0) {
          const demoReviews = generateDemoReviews();
          container.innerHTML = demoReviews;
        }
      })
      .catch((error) => {
        console.error("è·å–è¯„ä»·å¤±è´¥:", error);
        // æ˜¾ç¤ºé»˜è®¤å¡ç‰‡
        const demoReviews = generateDemoReviews();
        document.getElementById("latest-reviews").innerHTML = demoReviews;
      });
  });

  // ç”Ÿæˆç¤ºä¾‹é¤å…æ•°æ®
  function generateDemoRestaurants() {
    const restaurants = [
      { name: "æ±Ÿå—é£å‘³é¦†", cuisine: "æ±Ÿæµ™èœ", location: "å¾æ±‡åŒº" },
      { name: "å·æ¹˜é˜", cuisine: "å·èœ", location: "å˜‰å®šåŒº" },
      { name: "å‘³ä¹‹ç”ºæ—¥æ–™", cuisine: "æ—¥æœ¬æ–™ç†", location: "é»„æµ¦åŒº" },
      { name: "åœ°ä¸­æµ·é¤å…", cuisine: "è¥¿é¤", location: "æµ¦ä¸œæ–°åŒº" },
    ];

    let html = "";
    restaurants.forEach((restaurant) => {
      html += `
            <div class="col-md-3 col-sm-6 mb-4">
                <div class="card h-100 restaurant-card border-0 shadow-sm">
                    <div class="position-relative">
                        <img src="${
                          restaurant.image ||
                          "/static/images/restaurant-interior.jpg"
                        }"
                             class="card-img-top" alt="${
                               restaurant.name
                             }" style="height: 180px; object-fit: cover;">
                        <div class="position-absolute bottom-0 start-0 bg-dark bg-opacity-50 text-white p-2 m-2 rounded-pill small">
                            <i class="bi bi-geo-alt me-1"></i>${
                              restaurant.location
                            }
                        </div>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title mb-1">${restaurant.name}</h5>
                        <p class="card-text text-muted small mb-2">${
                          restaurant.cuisine
                        }</p>
                        <div class="rating mb-3">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-half"></i>
                            <span class="ms-1">4.5</span>
                            <span class="text-muted small ms-2">(${
                              Math.floor(Math.random() * 100) + 20
                            }æ¡è¯„ä»·)</span>
                        </div>
                        <a href="#" class="btn btn-sm btn-outline-primary w-100">æŸ¥çœ‹è¯¦æƒ…</a>
                    </div>
                </div>
            </div>
        `;
    });

    return html;
  }

  // ç”Ÿæˆç¤ºä¾‹è¯„ä»·æ•°æ®
  function generateDemoReviews() {
    const reviews = [
      {
        user: { name: "ç¾é£Ÿå®¶å°ç‹" },
        restaurant: { name: "æ±Ÿå—é£å‘³é¦†" },
        content:
          "è¿™å®¶çš„çº¢çƒ§è‚‰å…¥å£å³åŒ–ï¼Œæ­é…æ¸…çˆ½çš„é’èœï¼Œéå¸¸æ¨èï¼åº—å†…ç¯å¢ƒä¹Ÿå¾ˆä¼˜é›…ï¼ŒæœåŠ¡æ€åº¦ä¸€æµã€‚",
        rating: 5,
        timestamp: new Date("2025-05-15"),
      },
      {
        user: { name: "åƒè´§æå°å§" },
        restaurant: { name: "å·æ¹˜é˜" },
        content:
          "éº»è¾£é²œé¦™çš„å·èœï¼Œæ­£å®—çš„å‘³é“!éº»å©†è±†è…å’Œæ°´ç…®é±¼éƒ½éå¸¸åœ°é“ï¼Œä»·æ ¼ä¹Ÿå¾ˆå®æƒ ã€‚",
        rating: 4,
        timestamp: new Date("2025-05-10"),
      },
    ];

    let html = "";
    reviews.forEach((review) => {
      html += `
            <div class="col-md-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="flex-shrink-0">
                                <div class="rounded-circle bg-light d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                    <i class="bi bi-person text-secondary"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-0">${review.user.name}</h6>
                                <p class="text-muted small mb-0">${new Date(
                                  review.timestamp
                                ).toLocaleDateString()}</p>
                            </div>
                            <div class="rating ms-auto">
                                ${'<i class="bi bi-star-fill"></i>'.repeat(
                                  review.rating
                                )}
                                ${'<i class="bi bi-star"></i>'.repeat(
                                  5 - review.rating
                                )}
                            </div>
                        </div>
                        <h5 class="card-title">${review.restaurant.name}</h5>
                        <p class="card-text">${review.content}</p>
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <div>
                                <button class="btn btn-sm btn-light me-2">
                                    <i class="bi bi-hand-thumbs-up me-1"></i>ç‚¹èµ
                                </button>
                                <button class="btn btn-sm btn-light">
                                    <i class="bi bi-chat me-1"></i>è¯„è®º
                                </button>
                            </div>
                            <a href="#" class="btn btn-sm btn-outline-primary">æŸ¥çœ‹é¤å…</a>
                        </div>
                    </div>
                </div>
            </div>
        `;
    });

    return html;
  }
</script>
{% endblock %}
